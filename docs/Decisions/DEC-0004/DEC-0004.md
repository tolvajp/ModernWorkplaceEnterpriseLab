# Decision Log â€“ Group-based access and licensing model (enterprise modelling with simplified enforcement)

---

## Decision ID
- **ID:** DEC-0004
- **Status:** Draft
- **Date:** 2025-12-24
- **Owner:** Peter Tolvaj

---

## Context

The lab uses a Microsoft 365 E5 licensing baseline (DEC-0001) and an enterprise-only administrative model where all privileged access resolves to Global Administrator (DEC-0002), using a custom identity domain (DEC-0003).

In real enterprise environments, both **licensing** and **access** are expressed through group membership, often combined with:
- department-based grouping,
- role-based grouping,
- and layered license entitlements (base licenses plus add-ons).

Fully enforcing this complexity in a lab environment would introduce unnecessary cost and operational overhead. However, omitting it would remove an essential part of enterprise design reasoning.

This decision establishes a **group-based entitlement and segmentation model** that accurately represents enterprise thinking while enforcing a deliberately simplified lab reality.

---

## Scope

### In Scope
- Definition of a group-based entitlement model
- Concrete group structure and naming conventions
- License groups representing:
  - base license tiers
  - additional license entitlements (e.g. P1, P2)
- Role groups representing enterprise administrative roles
- Department groups representing organizational structure
- Explicit mapping between modelled entitlements and effective lab enforcement
- Use of group membership as the sole input for future automation

### Out of Scope
- Conditional Access policies
- Authentication method enforcement (MFA, passwordless)
- Privileged Identity Management (PIM)
- Device trust or enrollment
- Automation implementation details
- True least-privilege enforcement

---

## Decision

The lab adopts a **group-based access and licensing model** where:

1. All access, licensing, and organizational intent is expressed through Microsoft Entra ID group membership.
2. License entitlements are represented by multiple license groups, including base licenses and additional entitlements.
3. Role groups model enterprise administrative role separation.
4. Department groups model organizational structure and segmentation.
5. Despite this modelling:
   - All effective licensing is provided via Microsoft 365 E5.
   - All effective administrative access is granted via the Global Administrator role.
6. No user receives direct role or license assignments.

Group membership represents *enterprise design intent*, while technical enforcement is intentionally simplified for lab purposes.

---

## Design Principles

- Separation of intent and enforcement
- Group-centric entitlement management
- Explicit modelling of enterprise structures
- Deterministic automation readiness
- Pragmatic lab simplification

---

## Group Structure

### Group Naming Conventions

| Group Type | Prefix |
|----------|--------|
| License groups | `NWE-LIC-` |
| Role groups | `NWE-ROL-` |
| Department groups | `NWE-DEPT-` |
| Context / scope groups | `NWE-CTX-` |

---

### License Groups (Enterprise Model)

| Group Name | Modelled License | Effective License |
|----------|-----------------|------------------|
| NWE-LIC-M365E5 | Microsoft 365 E5 | Microsoft 365 E5 |
| NWE-LIC-M365E3 | Microsoft 365 E3 | Microsoft 365 E5 |
| NWE-LIC-M365E1 | Microsoft 365 E1 | Microsoft 365 E5 |
| NWE-LIC-EntraP1 | Entra ID P1 | Microsoft 365 E5 |
| NWE-LIC-EntraP2 | Entra ID P2 | Microsoft 365 E5 |
| NWE-LIC-EMS | EMS bundle | Microsoft 365 E5 |

Only `NWE-LIC-M365E5` results in an actual license assignment. Other license groups exist for modelling and documentation purposes.

---

### Role Groups (Enterprise Model)

| Group Name | Modelled Role | Effective Role |
|----------|---------------|----------------|
| NWE-ROL-GlobalAdmin | Global Administrator | Global Administrator |
| NWE-ROL-IntuneAdministrator | Intune Administrator | Global Administrator |
| NWE-ROL-SecurityAdministrator | Security Administrator | Global Administrator |
| NWE-ROL-UserAdministrator | User Administrator | Global Administrator |
| NWE-ROL-GlobalReader | Global Reader | Global Administrator |
| NWE-ROL-SecurityReader | Security Reader | Global Administrator |

All privileged users are Global Administrators in the lab. Role groups exist to demonstrate enterprise role separation.

---

### Department Groups (Enterprise Model)

| Group Name | Purpose |
|----------|---------|
| NWE-DEPT-IT | IT department users |
| NWE-DEPT-HR | Human Resources users |
| NWE-DEPT-Finance | Finance users |
| NWE-DEPT-Security | Security organization |
| NWE-DEPT-Operations | Operations users |

Department groups represent organizational structure and are intended for scoping policies, access, and reporting in later decisions.

---

## Rationale

This model mirrors how mature enterprises reason about identity:
- users belong to departments,
- departments and roles influence access,
- licenses are layered rather than monolithic.

By mapping all modelled licenses and roles to Microsoft 365 E5 and Global Administrator, the lab remains deterministic and cost-effective while preserving architectural correctness.

---

## Alternatives Considered

| Option | Pros | Cons | Reason Rejected |
|------|------|------|----------------|
| Direct user assignments | Simple | Poor auditability, no structure | Not enterprise-grade |
| Full least-privilege enforcement | Strong security | High complexity, cost | Out of scope for lab |

---

## Implications

### Positive
- Realistic enterprise identity and license modelling
- Clear foundation for automation and testing
- Supports future Conditional Access and PIM design
- Easy transition to real enforcement if required

### Negative
- All admins effectively have Global Administrator privileges
- Modelled separation is not technically enforced
- Requires clear documentation to avoid misinterpretation

---

## Security Considerations

Using Global Administrator and Microsoft 365 E5 universally is a deliberate lab simplification. The defined group structure ensures that future introduction of true role separation, Conditional Access, or license differentiation can be achieved without refactoring identity or automation logic.

---

## Rollback / Exit Strategy

Rollback consists of:
- Removing role and license assignments from groups
- Optionally deleting modelling-only groups

No partial or misleading enforcement remains after rollback.

---

## Validation

- [ ] No user has direct role assignments
- [ ] No user has direct license assignments
- [ ] All licensed users receive Microsoft 365 E5
- [ ] License, role, and department groups exist
- [ ] Group naming conventions are consistently applied

Validation is performed via Microsoft Entra ID role views, license assignment views, and group membership inspection.

---

## Notes

This decision intentionally models enterprise access, licensing, and organizational structure while enforcing a simplified lab reality. The group structure is designed to support future decisions around test users, Conditional Access, and privilege hardening without structural changes.
