# Decision Log — Group-based Privileged Identity Management (PIM) for Entra ID Roles

**Decision ID:** DEC-0006  
**Status:** Draft
**Date:** 2025-12-29  
**Owner:** Peter Tolvaj

---

## Context

The Modern Workplace Enterprise Lab aims to model a realistic, enterprise-grade identity governance baseline for Microsoft Entra ID. Administrative access must be auditable, time-bound, and consistently applied across all privileged roles.

Direct user-to-role assignments create implicit privileges, reduce auditability, and complicate automation and drift detection. To address this, privileged access must be mediated through a clearly defined abstraction that separates *eligibility*, *activation*, and *operational state*.

This decision defines the governance model for **group-based Privileged Identity Management (PIM)** for Entra ID directory roles.

---

## Decision

### 1. Role Assignment Model

- **All Entra ID directory roles are assigned exclusively to groups**.
- **No Entra role is ever assigned directly to a user**.
- Group-based assignment is mandatory and has no exceptions.

This ensures consistent privilege mediation, auditability, and automation compatibility.

---

### 2. Scope

**In Scope**
- Microsoft Entra ID *directory roles* only
- Group-based PIM eligibility and activation
- Role activation policy (time-bound, MFA, justification)

**Out of Scope**
- Azure RBAC (subscription / resource group roles)
- Workload-specific roles (Exchange, Defender, etc.)
- Conditional Access configuration
- MFA technology selection
- Monitoring and SIEM integration

Other role systems will be governed by separate decisions with their own naming conventions and control models.

---

### 3. Group-to-Role Mapping

- **One group represents exactly one Entra role**.
- A group is bound to **either** an *Eligible* **or** an *Active* role assignment — never both.
- For each role, a conscious security decision is made whether it is protected via PIM eligibility or requires permanent activation.

This avoids implicit privilege escalation and ensures roles are easy to reason about.

---

### 4. Eligible vs Active Roles

- If a role warrants PIM protection, it is protected **for all users**, without exception.
- Group membership **never grants immediate privileges** unless the role is explicitly defined as *Active*.
- PIM activation is required to transition from eligibility to effective privilege.

This distinction is security-driven and not a matter of convenience.

---

### 5. Group Membership Governance (Lab Disclaimer)

In this lab environment:
- All users are Global Administrators by definition (see DEC-0001).
- Group membership governance is therefore **not implemented**.

**Real-world recommendation (non-implemented):**
- Group ownership should itself be PIM-protected
- Membership changes should require approval
- Separation of duties between role eligibility management and role usage should be enforced

This limitation is explicitly documented to avoid misinterpretation of the lab model as production guidance.

---

### 6. Group Type

- **Security groups only**
- **Static membership only**

Dynamic groups are intentionally excluded to preserve deterministic privilege behavior and prevent attribute-driven privilege escalation.

---

### 7. Naming Convention

All role groups follow this strict pattern:

```
U-ENTRAROLE-<RoleName>-<ELIGIBLE | ACTIVE>
```

Rules:
- Exactly one group per role
- Exactly one state (ELIGIBLE or ACTIVE)
- Naming must fully describe role and privilege state

This enables immediate understanding without tooling and supports automation and audits.

---

### 8. PIM Activation Policy

For eligible roles, the following activation policy applies:

- **Multi-Factor Authentication:** Required
- **Justification:** Required
- **Approval:** Not required (lab only; may be required in production)
- **Maximum activation duration:** **Default 9 hours; role-specific overrides allowed**

**Rationale:**  
The default 9-hour limit aligns with a standard Dutch working day including lunch break (e.g., 09:00–17:30), avoiding unnecessary re-activation friction while preserving time-bounded privilege elevation.

Certain highly privileged roles (e.g. Global Administrator) may intentionally use **shorter activation windows** where full-day elevation is not justified and operational tasks are expected to be brief and deliberate.

**Break-glass accounts are exempt** from this policy and are handled separately.

---

### 9. Audit & Visibility Principles

The model must allow an auditor or engineer to answer the following questions quickly:

- *Who can activate a given role?*  
  → Members of the corresponding **ELIGIBLE** group

- *Who had this role at a specific time?*  
  → PIM activation logs

- *What is the intended exposure of the role?*  
  → Group existence and naming

Auditability must not depend on UI navigation or implicit knowledge.

---

### 10. Automation & Infrastructure as Code (IaC)

- Group creation and role assignment are **declarative and reproducible**
- Naming conventions are deterministic and machine-parseable
- Group membership represents **desired eligibility**, not runtime privilege state

**Important distinction:**
- PIM activation is an *operational runtime state* and is intentionally not modeled as declarative configuration
- Drift detection applies to group existence and bindings, not activation events

**Drift prevention policy:**  
To prevent configuration drift and accidental bypassing of defined PIM policies, **all Entra role groups must be created exclusively via automation**.

- Manual group creation for Entra role assignments is explicitly discouraged
- The authoritative creation path is the group factory function:

```
New-MWEGroup
```

This function is responsible for:
- Enforcing naming conventions
- Applying correct role binding intent (Eligible vs Active)
- Ensuring PIM policy alignment at creation time

Centralizing group creation in this function reduces policy drift, enforces governance decisions, and ensures consistent application of security controls across the environment.

---

### 11. Failure & Abuse Scenarios

The following scenarios were considered:

1. **Incorrect user added to an ELIGIBLE group**  
   Mitigation: MFA, justification, time-bound activation

2. **PIM service unavailable**  
   Mitigation: Dedicated break-glass accounts

3. **Role group deleted or misconfigured**  
   Mitigation: Redeployment via IaC

These scenarios ensure resilience without overengineering.

---

## Consequences

**Positive:**
- Strong separation between eligibility and usage
- High auditability and clarity
- Automation-friendly and reproducible
- Closely aligned with real enterprise practices

**Trade-offs:**
- Increased number of groups
- Requires naming discipline and documentation
- PIM activation remains an operational dependency

---

## Notes

This decision establishes the governance foundation for all Entra ID privileged access in the lab. Subsequent decisions will extend this model to Azure RBAC and workload-specific roles using separate control frameworks.
