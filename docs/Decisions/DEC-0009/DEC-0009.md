# Decision Log – Conditional Access Model
(Identity-centric, security-first)

---

## Decision ID
- **ID:** DEC-0009
- **Status:** Draft
- **Date:** 2026-01-10
- **Owner:** Peter Tolvaj

---

## Decision Domain

This decision defines the **Conditional Access (CA) model** for the Modern Workplace
Enterprise Lab.

The scope of this decision is **model-level only**:
- principles
- invariants
- decision logic
- security assumptions

This decision **does not implement** Conditional Access policies **yet**.

**Implementation dependency clarification**  
CA, MFA enforcement, and identity targeting form a **dependency chain**. CA policy
implementation is intentionally deferred until prerequisite decisions are finalized,
including:
- administrative identity classification (who counts as admin)
- user identity categorization (which user categories exist)
- MFA model targeting and assurance mapping (DEC-0008)

Implementing CA before these dependencies are resolved would introduce implicit
decisions and inconsistent enforcement. Therefore, CA + MFA + identity targeting
are expected to be implemented together, or after all prerequisite decisions are
complete.

Conditional Access is treated as a **security gate** that evaluates whether the
**expected security conditions are met** at sign-in time.  
It does **not** perform authentication, authorization, or entitlement decisions.

---

## Related Decisions

- **DEC-0006** — Group-based Privileged Identity Management (PIM)  
- **DEC-0008** — Authentication Baseline: MFA Model  

---

## Model Overview

The Conditional Access model is:

- **Identity-centric**
- **Security-first**
- **Fail-closed**
- **Baseline-driven with explicit, justified strictness**
- **Implementation-agnostic**

Conditional Access acts as a **security gate**:
- if the required security posture is satisfied → access may proceed
- if the security posture shows risk → the requirements may be elevated. 
- if requirements not met → access is blocked

Conditional Access **never grants access**; it only prevents insecure access.

---

## Atomic Decisions

### 1. Conditional Access MUST NOT be used to implement or duplicate authorization

**Decision**  
Conditional Access MUST NOT be used to implement, replace, or duplicate
**authorization** logic.

- CA MUST NOT be used to decide whether an identity is *entitled* to access a resource.
- Authorization is handled exclusively via **roles, groups, and permissions**.
- CA evaluates only whether the access attempt is **sufficiently secure**, not whether it is **permitted**.

**Context / Reasoning**  
CA is sometimes misused to “patch” authorization gaps by encoding entitlement into
policy targeting. This creates duplicated logic, hidden access paths, and audit
ambiguity. The chosen model keeps responsibilities clean:
- authorization remains in the identity/permission model
- CA remains a security gate that can be reasoned about independently

---

### 2. MFA is a condition evaluated by Conditional Access

**Decision**  
Multi-Factor Authentication (MFA) is treated as a **condition** within the CA model.

- CA expresses **which MFA assurance level is required**
- MFA policy defines **which authentication methods satisfy that assurance**
- CA policy enforces this in combination with other security inputs

**Context / Reasoning**  
Alternatives considered:
- fully separating MFA from CA (making CA “blind” to assurance requirements)
- embedding MFA logic directly into CA policy design (blurring responsibilities)

The chosen model preserves clear boundaries:
- DEC-0008 defines acceptable MFA methods and assurance categories
- CA uses those as conditions to determine whether access is secure

---

### 3. Baseline security is explicit, implementable, and is the minimum allowed posture

**Decision**  
The CA model defines an explicit **baseline security posture** that is:
- **implementable**
- the minimum acceptable posture for access (no identity may go below it)
- only maintainable or strengthenable (never weakened)

**Baseline security posture (minimum)**  
For **interactive human identities**, baseline security includes at minimum:
- **MFA required**, at the assurance level defined by **DEC-0008**
  (i.e., allowed MFA methods and assurance categories are governed by DEC-0008)
- **No high-confidence compromise** signal present (see Atomic Decision 5)
- Missing signals MUST NOT be used to relax requirements (see Atomic Decision 4)

**Strictness (above baseline)**  
Additional restrictions are permitted a
  access modes or requiring stronger posture for accesss explicit strictness above baseline, e.g.:
- device-based restrictions (when device trust/compliance exists), such as limiting

These strictness controls are **intended to be implementable later**, but are **not
implemented in this lab at this time**.

**Context / Reasoning**  
An abstract “baseline” invites policy drift because different implementers will
interpret “baseline” differently. An explicit, implementable baseline prevents
silent downgrade and allows later strictness (device, location, risk) to be added
without rewriting the foundation.

---

### 4. Unknown or missing context is untrusted

**Decision**  
Missing, unknown, or unavailable security signals MUST **not** be used to relax
security requirements.

- Unknown = **untrusted**
- A lack of information cannot reduce assurance

**Context / Reasoning**  
Fail-open behavior introduces implicit trust and security drift. In a security gate
model, absence of evidence must not become evidence of safety.

---

### 5. High-confidence malicious activity results in unconditional access denial (except break-glass)

**Decision**  
When a high-confidence malicious activity signal is present, access is **blocked
unconditionally** for all **non-break-glass** identity types.

- Applies to:
  - standard users
  - administrative users
  - service / automation identities
- Independent of:
  - MFA state
  - device context
  - location

High confidence malicious activity signals include but not limited to:
  - Leaked credentials
  - Password spray
  - Malware detection
  - Tamper attempt
  - Sign-in from known malicious IP
  - Credential harvesting detected
  - LSASS memory access
  - C2 (Command & Control) communication
  - Persistence mechanism detected
  - Ransomware behavior
  - Privilege escalation exploit detected

    Not all listed signals are required to be implemented in this lab.
    Signals may originate from identity, endpoint, or infrastructure telemetry. 


**Break-glass treatment**  
Break-glass identities are **explicitly excluded from CA enforcement** and are not
subject to compromise-driven CA blocking. Break-glass access MUST remain possible
even if compromise signals produce false positives.

**Operational visibility**  
High-confidence compromise events MUST generate operational visibility (logging,
alerting, investigation trigger).

**Context / Reasoning**  
At high confidence, “more authentication” does not materially reduce risk; the
assumption is that the identity is compromised. The correct response is deny and
investigate. However, blocking break-glass would remove the recovery path and
introduce an unacceptable tenant-lockout risk in false positive scenarios.
Therefore, break-glass remains outside CA enforcement by design.

Definition of high confidence compromise signals should be defined by SOC.

---

### 6. Location / network context is a supplementary signal only

**Decision**  
Location and network context may only contribute to **increased strictness** when
combined with other risk signals. Location is never used:
- as a standalone trust signal
- to relax security requirements

**Context / Reasoning**  
“Trusted network” thinking is incompatible with Zero Trust and is susceptible to
bypass (VPN/proxy). Location can still be useful as a negative or amplifying signal
(e.g., unexpected geography), but must not grant trust on its own.

---

### 7. Conditional Access is evaluated at sign-in time only (no session control in this model)

**Decision**  
Conditional Access is treated as a **sign-in gate**:
- Decisions are made at authentication time
- Session-level and continuous enforcement are out of scope for this model

**Session control placement**  
Session control / continuous access enforcement, if present, belongs to separate
security domains - Microsoft Defender for Cloud apps - and is **not assumed** by this CA design. It may or may not be
handled in the future; this decision does not commit to later implementation.

**Context / Reasoning**  
Without a runtime signal/enforcement stack, attempting to model “continuous CA”
adds complexity without real security effect. Keeping CA as a sign-in gate preserves
a clean, auditable responsibility boundary.

---

### 8. Application-agnostic baseline with explicit exceptions

**Decision**  
The CA model applies a **global, application-agnostic baseline**.
Application-specific strictness is allowed only as an explicit, justified exception.

**Context / Reasoning**  
Making the model app-sensitive by default tends to create policy sprawl and can
accidentally reintroduce authorization logic into CA. A global baseline keeps the
security gate consistent, with rare, explicit deviations where justified.

---

### 9. Legacy authentication is incompatible by default

**Decision**  
Authentication methods/protocols that cannot satisfy the baseline security posture
are considered **incompatible by default**.

**Context / Reasoning**  
Legacy authentication is a direct bypass of modern assurance signals and MFA
requirements. Exceptions may exist, but must be explicitly justified and governed
outside the baseline model to avoid silent downgrade.

---

### 10. Operational visibility is a model requirement (CA must not be a silent gate)

**Decision**  
The CA model requires operational visibility for significant security events,
including at minimum:
- high-confidence compromise-driven blocks
- elevated risk-driven strictness triggers
- exception usage

This decision does not prescribe tooling; it defines the expectation that such
events are observable and reviewable.

**Context / Reasoning**  
A security gate that blocks or tightens access without visibility creates blind
spots and prevents investigation. Visibility is required for auditability and for
security decisions to be operationally meaningful.

---

### 11. Automation and service identities are in scope conceptually; detailed modeling is out of scope for this lab

**Decision**  
Automation and service identities are within the **conceptual scope** of CA:
- they must be governable via security signals
- compromise signals must be enforceable (deny)

However, the **detailed CA model and implementation** for automation identities are
explicitly out of scope for this lab.

**Context / Reasoning**  
Treating automation identities as “out of scope” can create an implicit exemption
and a security hole. Conversely, fully modeling them here would expand the lab
beyond its intended scope and mix human and non-interactive logic. This decision
separates conceptual responsibility (in scope) from lab detail level (out of scope).

---

### 12. Exceptions are allowed only with explicit, temporary governance

**Decision**  
Exceptions to the CA model are permitted only with:
- documented business justification
- explicit approval
- defined expiration
- regular review

**Context / Reasoning**  
Exceptions are a common source of policy drift. Allowing exceptions without strong
governance weakens a security-first model. This decision permits exceptions while
keeping them visible, temporary, and controlled.

---

## Implementation Status

This decision **does not implement** Conditional Access.

Conditional Access implementation is intentionally deferred until prerequisite
decisions for MFA targeting and identity categorization are finalized. This avoids
partial or inconsistent enforcement and prevents implicit decisions from entering
policy.

---

## Validation

- [x] CA model responsibilities are clearly bounded (security gate, not authorization)  
- [x] MFA and CA responsibilities are separated and composable  
- [x] Fail-closed principles are enforced (unknown is untrusted)  
- [x] Compromise handling is explicit and break-glass-safe  
- [x] Automation identities are conceptually in scope without lab scope creep  
- [x] No enforcement is performed by this decision  

---
