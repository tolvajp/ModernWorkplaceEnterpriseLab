# Decision Log – Authentication Baseline: MFA Model
(Device-aware, phishing-resistant, break-glass safe)

---

## Decision ID
- **ID:** DEC-0008
- **Status:** Accepted
- **Date:** 2026-01-10
- **Owner:** Peter Tolvaj

---

## Decision Domain

This decision defines the **authentication baseline** for the Modern Workplace
Enterprise Lab, with a focus on **Multi-Factor Authentication (MFA)** as a
non-optional security invariant.

The scope of this decision is **model-level**:
- principles
- invariants
- acceptable authentication methods
- identity categorization for authentication purposes

This decision **does not implement MFA**.

**Conditional Access (CA)** is treated as the enforcement mechanism, but CA policy
design, targeting, and rollout are handled in a **separate decision domain**.

MFA, Conditional Access, and administrative identity enforcement will be
implemented **together**, once all prerequisite decisions are finalized, to
avoid partial or inconsistent enforcement.

---

## Related Decisions

- **DEC-0000** — Platform selection (Entra ID + Intune foundation)
- **DEC-0002** — Account and administrative role model
- **DEC-0006** — Group-based PIM for Entra ID Roles
- **DEC-0007** — Module refactoring principles (preconditions, least privilege, auditability)

---

## Atomic Decisions

1. MFA is a baseline requirement for interactive sign-ins  
2. MFA applies to all interactive user identities  
3. MFA methods are categorized by strength and allowed usage  
4. Administrative MFA requirements must not be relaxed  
5. Device context is a valid input signal, not a substitute  
6. Unknown or missing device context is untrusted  
7. Break-glass accounts are an explicit MFA exception  
8. Phishing-resistant, multi-factor methods satisfy MFA  
9. Passwordless multi-factor authentication is MFA by definition  
10. Legacy authentication is incompatible with the MFA baseline  
11. Authentication scoping is defined through identity categorization groups  

---

## Atomic Decisions (Detailed)

### Atomic Decision 1 – MFA is a baseline requirement for interactive sign-ins

**Decision**  
MFA is a **baseline requirement** for all **interactive** sign-ins.
It is not optional and not risk-triggered.

**Context**  
A baseline model avoids security drift, simplifies auditing, and provides
operational predictability as the environment evolves.
Emergency access is handled explicitly rather than weakening the baseline.

---

### Atomic Decision 2 – MFA applies to all interactive user identities

**Decision**  
MFA applies to **all interactive user identities**, including:
- standard user accounts
- dedicated administrative accounts

**Context**  
A baseline is only meaningful if it applies uniformly.
Break-glass identities are the only documented exception (Atomic Decision 7).

---

### Atomic Decision 3 – Categorized MFA methods

**Decision**  
MFA methods are categorized based on their resistance to phishing,
strength of factor binding, and suitability for different identity risk levels.

#### Category A – Phishing-resistant, multi-factor (preferred)

**Allowed for:**  
- Standard users  
- Administrative users  

**Methods:**  
- Windows Hello for Business  
- FIDO2 security keys  
- Passkeys / WebAuthn authenticators  

#### Category B – Strong but phishing-susceptible (restricted)

**Allowed for:**  
- Standard users  

**Not allowed for:**  
- Administrative users  

**Methods:**  
- Microsoft Authenticator push notifications with number matching  

#### Category C – Weak or legacy MFA (disallowed)

**Allowed for:**  
- None  

**Methods:**  
- SMS OTP  
- Voice call MFA  
- Email OTP  
- Any MFA method based solely on shared secrets  

**Context**  
Not all MFA methods provide equivalent security guarantees.
Categorization prevents silent downgrade of authentication assurance and
enables differentiated treatment of identities based on risk.

---

### Atomic Decision 4 – Administrative MFA invariants (guardrail)

**Decision**  
This decision does **not** introduce MFA for administrative accounts.
It constrains how **future enforcement decisions** may select MFA methods
for different identity risk classes.

Administrative identities:
- **must always use Category A MFA methods**
  (phishing-resistant, multi-factor authentication)
- **must not use Category B or Category C MFA methods**
  under any circumstances

Standard user identities:
- may use **Category A or Category B** MFA methods
- must not use Category C MFA methods

**Context**  
Administrative identities represent the highest risk and blast radius.
Restricting them to Category A MFA methods ensures the strongest possible
authentication guarantees and prevents future policy optimizations from
silently lowering assurance.

This decision acts as a guardrail on MFA method selection and must be
respected by all future Conditional Access and authentication enforcement
decisions.

---

### Atomic Decision 5 – Device context is a valid input signal, not a substitute

**Decision**  
Device context may be considered an **input signal** but **cannot replace** MFA.

- For standard users, device context may influence *how* MFA is satisfied
- For administrative users, device context must never reduce MFA requirements

**Context**  
Device trust increases confidence but does not replace identity proofing.
This preserves a Zero Trust authentication model.

---

### Atomic Decision 6 – Unknown or missing device context is untrusted

**Decision**  
Missing, unknown, or unreliable device context is treated as **untrusted**.

**Context**  
Absence of information must not silently downgrade authentication assurance.

---

### Atomic Decision 7 – Break-glass accounts are an explicit MFA exception

**Decision**  
Break-glass (emergency access) accounts are an **explicit, documented exception**
to the MFA baseline.

- MFA is not required for break-glass accounts
- These accounts exist solely for recovery scenarios

**Context**  
Baseline MFA must coexist with a survivable recovery path.
This exception is intentional, minimal, reviewable, and governed.

---

### Atomic Decision 8 – Phishing-resistant multi-factor methods satisfy MFA

**Decision**  
Phishing-resistant authentication methods that use **multiple independent
factors** are treated as **MFA satisfied**.

**Context**  
MFA is defined by independent factors, not prompts.
Methods such as Windows Hello for Business, FIDO2, and passkeys enforce
possession plus PIN or biometric verification within a single authenticator.
Additional prompts add friction without improving security.

---

### Atomic Decision 9 – Passwordless multi-factor authentication is MFA by definition

**Decision**  
Passwordless methods that use multiple independent factors satisfy MFA
requirements without additional steps.

**Context**  
Passwordless does not imply single-factor.
Multi-factor passwordless authentication is inherently MFA.

---

### Atomic Decision 10 – Legacy authentication is incompatible with the MFA baseline

**Decision**  
Legacy authentication is incompatible with the MFA baseline and is disallowed
by default.

**Context**  
Protocols that cannot negotiate MFA represent a direct bypass of the baseline.
Any exception requires a separate, explicit decision.

---

### Atomic Decision 11 – Authentication scoping and identity categorization

**Decision**  
Authentication scoping is expressed using **explicit identity groups** that define
which identities later authentication policies will apply to.

This decision defines **identity categorization and policy scope only**.
Authentication requirements and enforcement are defined in a separate
decision domain.

**Authoritative groups**

- **U-AUTH-INTERACTIVE** — standard interactive user identities  
- **U-AUTH-ADMIN-INTERACTIVE** — administrative interactive identities  
- **U-AUTH-EXCLUDE-BREAKGLASS** — emergency access identities  

**Group semantics**

- Administrative identities are represented by a **dynamic group** based on a
  deterministic classification rule to prevent accidental omission
- Standard users include all interactive users not classified as admin or break-glass
- Break-glass identities are represented by a **static, manually governed group**
- Service and workload identities are **out of scope** and not subject to MFA

**Context**  
These groups define *who policies apply to*, not *what the policies do*.
They serve the same purpose as deployment rings or targeting scopes.

---

## Implementation Status

This decision **does not implement MFA**.

Implementation requires additional decisions, including:
- Conditional Access policy design
- Administrative identity enforcement model
- User and device scope decisions

These will be implemented **together** to avoid partial or inconsistent enforcement.

---

## Validation

- [x] MFA baseline is explicitly defined
- [x] Exceptions are minimal and documented
- [x] Administrative guardrails are explicit
- [x] MFA methods are clearly categorized
- [x] No enforcement is performed by this decision

---

## Notes

- MFA exemptions currently apply **only** to break-glass accounts  
- Service identities are intentionally out of scope  
- These rules are **provisional** and may be revisited in later decisions
