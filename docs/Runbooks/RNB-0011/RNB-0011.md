# Runbook – Entra role group provisioning (DEC-0006)

## Status
Executed

---

## Preconditions
Conditions that **must be true** before execution.

- [x] Related decision (**DEC-0010**) is in status **Accepted**
- [x] Microsoft Entra ID tenant available
- [x] Microsoft Graph PowerShell SDK installed
- [x] Executing identity has sufficient permissions to manage roles and role policies

---

## Risks & Safety Notes
Describe **known risks**, limitations, and safety considerations.

- Group creation is idempotent by intent; re-execution will fail if role groups already exist.
- Directory roles may be **activated automatically** if not already active
- Role management policy settings (activation duration) are modified at role scope
- Active role assignments grant immediate privileges to group members
- No users are assigned directly; privilege is only effective via group membership
- Script terminates on first error (fail-fast behavior)
---

## Procedure

### Step 1 – Preparation
Describe preparatory actions.

- Review **DEC-0006** to confirm the role distribution and assignment model
- Review `RNB-0006.json` to confirm:
  - target roles
  - assignment type (Active / Eligible)
  - maximum activation duration
- Ensure execution is performed in a **lab / non-production tenant**
- Ensure no manually created role assignment groups exist using the same naming convention

---

### Step 2 – Execution
Describe the core operational steps in **conceptual terms**.

- Execute `SCR-0006.ps1` from a clean PowerShell session

---

### Step 3 – Validation
Describe how to confirm that execution was successful.

- [x] Confirm all role groups defined in `RNB-0006.json` exist
- [x] Confirm group naming matches: <`U-ENTRAROLE-<RoleName>-ELIGIBLE`|`U-ENTRAROLE-<RoleName>-ACTIVE`>
- [x] Confirm role assignments are visible in Azure portal | Privileged Identity Management | My audit history
---

## Rollback / Exit Strategy
Describe how to **undo, abandon, or safely exit** if required.

- Remove users from role assignment groups
- Delete role assignment groups
- Removing the group automatically removes the role assignment
- Revert role management policy settings if needed
- No irreversible tenant-level changes are performed

---

## Notes
Free-form section for observations, caveats, or follow-up actions.

> This runbook establishes the **role intent and privilege assignment layer only**.  
> User-to-role assignment via group membership is governed by subsequent operational procedures and access reviews.
