# Runbook – License group provisioning (DEC-0005)

## Status
Executed

---

## Preconditions
Conditions that **must be true** before execution.

- [x] Related decision (**DEC-0008**) is in status **Accepted**
- [x] Microsoft Entra ID tenant available
- [x] Microsoft Graph PowerShell SDK installed

---

## Risks & Safety Notes
Describe **known risks**, limitations, and safety considerations.

- Group creation is idempotent by intent; re-execution will fail if groups already exist
- License assignment is performed only for entries with `mock: false`
- Group-based licensing has no effect until users are added to the groups
- Deleting groups only possible when licenses are unassigned.

---

## Procedure

### Step 1 – Preparation
Describe preparatory actions.

- Review **DEC-0005** to confirm the license distribution model
- Review `RNB-0005.json` to confirm desired license groups and mock flags
- Ensure execution is performed in a **lab / non-production tenant**
- Ensure no manual license groups exist with the same naming convention

---

### Step 2 – Execution
Describe the core operational steps in **conceptual terms**.

- Execute `SCR-0005.ps1` from a clean PowerShell session
- Script loads `RNB-0005.json` as the desired state
- Script iterates through `licenseGroups`
- For each entry:
  - Create a security group named `U-LICENSE-<SkuPartNumber>`
  - Assign license to the group unless `mock: true`
- Script terminates on any error (fail-fast)

---

### Step 3 – Validation
Describe how to confirm that execution was successful.

- Confirm all groups defined in `RNB-0005.json` exist
- Confirm naming matches `U-LICENSE-<SkuPartNumber>`
- For non-mock groups, confirm license is assigned to the group
- Confirm no additional groups were created

---

## Validation Checklist
- [x] Runbook objective achieved
- [x] No out-of-scope actions performed
- [x] License groups created according to DEC-0005
- [x] Naming convention enforced consistently
- [x] No users licensed directly

---

## Rollback / Exit Strategy
Describe how to **undo, abandon, or safely exit** if required.

- Remove any users added to license groups (if applicable)
- Delete the created license groups
- Group deletion automatically removes group-based license assignment
- No irreversible tenant-level changes are performed

---

## Notes
Free-form section for observations, caveats, or follow-up actions.

> This runbook establishes the **license intent layer only**.  
> User-to-license assignment via group membership is handled by a subsequent decision and runbook.
